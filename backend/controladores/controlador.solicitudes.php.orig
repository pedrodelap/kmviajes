<<<<<<< HEAD
<?php

class ControladorSolicitudes{

	#MOSTRAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrMostrarSolicitudes($item, $valor){

		$tabla = "tb_solicitud";

		$respuesta = ModeloSolicitudes::mdlMostrarSolicitudes($tabla, $item, $valor);

		return $respuesta;

	}

	#MOSTRAR PAQUETE DE SOLICITUD
	#-----------------------------------------------------
	static public function ctrMostrarPaqueteDeSolicitud($item, $valor){

		$tabla = "tb_paquetes";

		$respuesta = ModeloSolicitudes::MostrarPaqueteDeSolicitud($tabla, $item, $valor);

		$datosPaqueteMostrar = "";
		
		foreach($respuesta as $row => $item){

			$datosPaqueteMostrar .= '<div class="vertical-timeline-item vertical-timeline-element">
										<div><span class="vertical-timeline-element-icon bounce-in"><i class="badge badge-dot badge-dot-xl badge-primary"> </i></span>
											<div class="vertical-timeline-element-content bounce-in">
												<h4 class="timeline-title">'.$item["titulo"].'</h4>
										</div>
									</div>
									<div class="vertical-timeline-item vertical-timeline-element">
										<div><span class="vertical-timeline-element-icon bounce-in"><i class="badge badge-dot badge-dot-xl badge-primary"> </i></span>
											<div class="vertical-timeline-element-content bounce-in">
												<h4 class="timeline-title"></h4>
												<p>Aerolínea </p><span class="vertical-timeline-element-date">'.$item["aerolinea_nombre"].'</span></div>
												<p>Ciudad </p><span class="vertical-timeline-element-date">'.$item["ciudad_pais"].'</span></div>
										</div>
									</div>						
									
									<div class="vertical-timeline-item vertical-timeline-element">
										<div><span class="vertical-timeline-element-icon bounce-in"><i class="badge badge-dot badge-dot-xl badge-success"> </i></span>
											<div class="vertical-timeline-element-content bounce-in">
												<h4 class="timeline-title">Datos del Paquete</h4>
												<p>Monto en nuevos soles <b class="text-primary">S/. '.$item["precio_sol"].'</b></p>
												<p>Monto en nuevos dolares <b class="text-primary">$ '.$item["precio_dolar"].'</b></p>
												<p>Cantidad Adultos / niños <span class="text-success">'.$item["cantidad_adultos"].' '.$item["cantidad_ninios"].'</span></p><span class="vertical-timeline-element-date"></span></div>
										</div>
									</div>
									<div class="vertical-timeline-item vertical-timeline-element">
										<div><span class="vertical-timeline-element-icon bounce-in"><i class="badge badge-dot badge-dot-xl badge-warning"> </i></span>
											<div class="vertical-timeline-element-content bounce-in">
												<p>Fecha de duración del paquete turístico<b class=""></b></p>
												<p>'.$item["fecha_mostrar"].' </p><span class="vertical-timeline-element-date"></span></div>
										</div>
									</div>';
			}

		return $datosPaqueteMostrar;

	}


	
	#CREAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrCrearSolicitud(){


		if(isset($_POST["hidden_cliente_desde_cotizacion"])){

			$clienteDesdeCotizacion = $_POST["hidden_cliente_desde_cotizacion"];

		}

		if(isset($_POST["clienteNuevoNombres"])){

			if(preg_match('/^[a-zA-Z0-9ñÑáéíóúÁÉÍÓÚ ]+$/', $_POST["clienteNuevoNombres"]) &&
			   preg_match('/^[a-zA-Z0-9ñÑáéíóúÁÉÍÓÚ ]+$/', $_POST["clienteNuevoApellidos"]) &&			   
			   preg_match('/^[a-zA-Z. ]+$/', $_POST["clienteNuevoTipoDocumento"]) &&
			   preg_match('/^[0-9]+$/', $_POST["clienteNuevoNumeroDocumento"]) &&
			   preg_match('/^[^0-9][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[@][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[.][a-zA-Z]{2,4}$/', $_POST["clienteNuevoCorreo"]) &&
			   preg_match('/^[()\-0-9 ]+$/', $_POST["clienteNuevoTelefono"])){

			   	$tabla = "tb_clientes";

				$datos = array("nombres"=>mb_strtoupper($_POST["clienteNuevoNombres"]),
							   "apellidos"=>mb_strtoupper($_POST["clienteNuevoApellidos"]),
							   "tipo_documento"=>$_POST["clienteNuevoTipoDocumento"],
							   "numero_documento"=>$_POST["clienteNuevoNumeroDocumento"],
							   "correo"=>mb_strtolower($_POST["clienteNuevoCorreo"]),
							   "telefono"=>$_POST["clienteNuevoTelefono"],
							   "fecha_nacimiento"=>$_POST["clienteNuevoFechaNacimiento"]);


			   	$respuesta = ModeloClientes::mdlIngresarCliente($tabla, $datos);

			   	if($respuesta == "ok"){

					echo'<script>

					Swal.fire({
						  type: "success",
						  title: "El cliente ha sido guardado correctamente",
						  showConfirmButton: true,
						  confirmButtonText: "Cerrar",
						  closeOnConfirm: false
						  }).then((result) => {
									if (result.value) {';

										if(isset($_POST["hidden_cliente_desde_cotizacion"])){

											echo'window.location = "cotizacion-crear";';

										} else {

											echo'window.location = "clientes";';

										}
										
								echo'}
								})

					</script>';

				}

			}else{

				echo'<script>

					Swal.fire({
						  type: "error",
						  title: "¡El cliente no puede ir vacío o llevar caracteres especiales!",
						  showConfirmButton: true,
						  confirmButtonText: "Cerrar",
						  closeOnConfirm: false
						  }).then((result) => {
							if (result.value) {';

								if(isset($_POST["hidden_cliente_desde_cotizacion"])){

									echo'window.location = "cotizacion-crear";';

								} else {

									echo'window.location = "clientes";';

								}

						echo'}
						})

			  	</script>';

			}

		}

	}

	#EDITAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrEditarSolicitud(){

		if(isset($_POST["clienteEditarNombres"])){

			if(preg_match('/^[a-zA-Z0-9ñÑáéíóúÁÉÍÓÚ ]+$/', $_POST["clienteEditarNombres"]) &&
			   preg_match('/^[a-zA-Z0-9ñÑáéíóúÁÉÍÓÚ ]+$/', $_POST["clienteEditarApellidos"]) &&			   
			   preg_match('/^[a-zA-Z. ]+$/', $_POST["clienteEditarTipoDocumento"]) &&
			   preg_match('/^[0-9]+$/', $_POST["clienteEditarNumeroDocumento"]) &&
			   preg_match('/^[^0-9][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[@][a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)*[.][a-zA-Z]{2,4}$/', $_POST["clienteEditarCorreo"]) &&
			   preg_match('/^[()\-0-9 ]+$/', $_POST["clienteEditarTelefono"])){

			   	$tabla = "tb_clientes";

				$datos = array("id"=>$_POST["idCliente"],
							   "nombres"=>mb_strtoupper($_POST["clienteEditarNombres"]),
							   "apellidos"=>mb_strtoupper($_POST["clienteEditarApellidos"]),
							   "tipo_documento"=>$_POST["clienteEditarTipoDocumento"],
							   "numero_documento"=>$_POST["clienteEditarNumeroDocumento"],
							   "correo"=>mb_strtolower($_POST["clienteEditarCorreo"]),
							   "telefono"=>$_POST["clienteEditarTelefono"],
							   "fecha_nacimiento"=>$_POST["clienteEditarFechaNacimiento"]);

			   	$respuesta = ModeloClientes::mdlEditarCliente($tabla, $datos);

			   	if($respuesta == "ok"){

					echo'<script>

					Swal.fire({
						  type: "success",
						  title: "El cliente ha sido cambiado correctamente",
						  showConfirmButton: true,
						  confirmButtonText: "Cerrar",
						  closeOnConfirm: false
						  }).then((result) => {
									if (result.value) {

										window.location = "clientes";

									}
								})

					</script>';

				}

			}else{

				echo'<script>

					Swal.fire({
						  type: "error",
						  title: "¡El cliente no puede ir vacío o llevar caracteres especiales!",
						  showConfirmButton: true,
						  confirmButtonText: "Cerrar",
						  closeOnConfirm: false
						  }).then((result) => {
							if (result.value) {

							window.location = "clientes";

							}
						})

			  	</script>';



			}

		}

	}

	#ELIMINAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrEliminarSolicitud(){

		if(isset($_GET["idCliente"])){

			$tabla ="tb_clientes";
			$datos = $_GET["idCliente"];

			$respuesta = ModeloClientes::mdlEliminarCliente($tabla, $datos);

			if($respuesta == "ok"){

				echo'<script>

				Swal.fire({
					  type: "success",
					  title: "El cliente ha sido borrado correctamente",
					  showConfirmButton: true,
					  confirmButtonText: "Cerrar",
					  closeOnConfirm: false
					  }).then((result) => {
								if (result.value) {

								window.location = "clientes";

								}
							})

				</script>';

			}		

		}

	}

}

=======
<?php

class ControladorSolicitudes{

	#MOSTRAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrMostrarSolicitudes($item, $valor){

		$tabla = "tb_solicitud";

		$respuesta = ModeloSolicitudes::mdlMostrarSolicitudes($tabla, $item, $valor);

		return $respuesta;

	}

	#MOSTRAR PAQUETE DE SOLICITUD
	#-----------------------------------------------------
	static public function ctrMostrarPaqueteDeSolicitud($item, $valor){

		$tabla = "tb_paquetes";

		$respuesta = ModeloSolicitudes::MostrarPaqueteDeSolicitud($tabla, $item, $valor);

		if ($respuesta != "error"){

			$datosPaqueteMostrar1 ='<div class="vertical-timeline-item vertical-timeline-element">
										<div><span class="vertical-timeline-element-icon bounce-in"><i class="badge badge-dot badge-dot-xl badge-primary"> </i></span>
											<div class="vertical-timeline-element-content bounce-in">
												<h4 class="timeline-title">'.$respuesta["titulo"].'</h4>
												<p>Aerolínea <span class="text-primary">S/. '.$respuesta["aerolinea_nombre"].'</span></p>
												<p>Ciudad <span class="text-primary">$ '.$respuesta["ciudad_pais"].'</span></p></div>
										</div>
									</div>									
									<div class="vertical-timeline-item vertical-timeline-element">
										<div><span class="vertical-timeline-element-icon bounce-in"><i class="badge badge-dot badge-dot-xl badge-success"> </i></span>
											<div class="vertical-timeline-element-content bounce-in">
												<h4 class="timeline-title">Datos del Paquete</h4>
												<p>Monto en nuevos soles <span class="text-success">S/. '.$respuesta["precio_sol"].'</span></p>
												<p>Monto en nuevos dolares <span class="text-success">$ '.$respuesta["precio_dolar"].'</span></p></div>
										</div>
									</div>
									<div class="vertical-timeline-item vertical-timeline-element">
										<div><span class="vertical-timeline-element-icon bounce-in"><i class="badge badge-dot badge-dot-xl badge-warning"> </i></span>
											<div class="vertical-timeline-element-content bounce-in">
												<p>Fecha de duración del paquete turístico<b class=""></b></p>
												<p>'.$respuesta["fecha_mostrar"].' </p><span class="vertical-timeline-element-date"></span></div>
										</div>
									</div>';
			
		}else {

			$datosPaqueteMostrar1 = "error";

		}

		return $datosPaqueteMostrar1;

	}
	
	#CREAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrCrearSolicitud(){
	}

	#EDITAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrEditarSolicitud(){
	}

	#ELIMINAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrEliminarSolicitud(){
	}

	#ELIMINAR SOLICITUDES
	#-----------------------------------------------------
	static public function ctrEstadoRegistradaACotizada($datos){

		$tabla = 'tb_solicitudes_historial';

		$respuesta = ModeloSolicitudes::mdlEstadoRegistradaACotizada($tabla, $datos);

		return $respuesta;
	}


	#SOLICITUDES SIN REVISAR
	#------------------------------------------------------------
	public static function ctrCantidadSolicitudesSinRevisar(){

		$respuesta = ModeloMensajes::mdlSolicitudesSinRevisar("tb_solicitud");

		$sumaRevision = 0;

		foreach ($respuesta as $row => $item) {

			if($item["revision"] == 0){

				++$sumaRevision;	
			}

		}
		
		if($sumaRevision != 0) {

			echo '<a href="solicitudes" class="nav-link">Solicitudes
					<div class="ml-auto badge badge-pill badge-info">'.$sumaRevision.'
					</div>
				  </a>';

		}else{

			echo '<a href="solicitudes" class="nav-link">Solicitudes
				  </a>';

		}

	}

	#SOLICITUDES SIN REVISAR
	#------------------------------------------------------------
	public static function ctrSolicitudesSinRevisar(){

		$respuesta = ModeloMensajes::mdlSolicitudesSinRevisar("tb_solicitud");

		$sumaRevision = 0;

		foreach ($respuesta as $row => $item) {

			if($item["revision"] == 0){

				++$sumaRevision;	
			}

		}
		
		if($sumaRevision != 0) {

			echo '<li class="btn-group nav-item ">
					<a href="solicitudes" class="p-1 mr-0 btn btn-link">
						<span class="icon-wrapper icon-wrapper-alt rounded-circle">
							<span class="icon-wrapper-bg bg-danger"></span>
								<i class="text-danger icon-anim-pulse fas fa-envelope-open-text"></i>
								<span class="badge badge-dot badge-dot-sm badge-danger">1</span>
						</span>
					</a>
				</li>';

		}else{

			echo '<li class="btn-group nav-item ">
					<a href="solicitudes" class="p-1 mr-0 btn btn-link">
						<span class="icon-wrapper icon-wrapper-alt rounded-circle">
							<span class="icon-wrapper-bg bg-primary"></span>
								<i class="fas fa-envelope-open-text"></i>
								<span class="badge badge-dot badge-dot-sm"></span>
						</span>
					</a>
				</li>';

		}

	}

	#SOLICITUDES REVISADOS
	#------------------------------------------------------------
	public static function ctrSolicitudesRevisadasController($datos){

		$datosController = $datos;

		$respuesta = ModeloSolicitudes::mdlSolicitudesRevisadas($datosController, "tb_solicitud");

		echo $respuesta;

	}	


}

>>>>>>> origin/mantis
